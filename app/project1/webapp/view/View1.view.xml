<mvc:View
    controllerName="project1.controller.View1"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:u="sap.ui.unified"
    xmlns:uiTable="sap.ui.table"
    xmlns:layout="sap.ui.layout"
    xmlns:f="sap.f"
>
    <f:DynamicPage showFooter="true">
        <f:title>
            <f:DynamicPageTitle>
                <f:heading>
                    <Title text="User Access Management" level="H2" />
                </f:heading>
            </f:DynamicPageTitle>
        </f:title>

        <f:content>
            <VBox class="sapUiMediumMargin">

                <!-- Upload Actions -->
                <Panel
                    headerText="Upload Actions"
                    expandable="false"
                    class="sapUiNoContentPadding sapUiResponsiveMargin"
                    width="100%"
                >
                    <HBox
                        justifyContent="SpaceBetween"
                        alignItems="Center"
                        class="sapUiSmallMargin"
                    >
                        <!-- Left Section -->
                        <VBox class="sapUiSmallMarginEnd" width="45%">
                            <Button
                                id="downloadbtn"
                                text="Download Template"
                                type="Emphasized"
                                icon="sap-icon://download"
                                press="onDownloadSample"
                            />
                        </VBox>

                        <!-- Right Section -->
                        <VBox
                            class="sapUiSmallMarginEnd"
                            alignItems="End"
                            width="45%"
                        >
                            <Label
                                text="Upload Your File"
                                class="sapUiTinyMarginBottom"
                            />
                            <u:FileUploader
                                id="fileUploader"
                                name="userUpload"
                                fileType="xlsx"
                                width="16rem"
                                change=".onFileUpload"
                                placeholder="Choose XLSX file"
                            />
                        </VBox>
                    </HBox>
                </Panel>

                <!-- Table Section -->
                <Panel
                    id="cmoPanel"
                    expandable="true"
                    expanded="true"
                    class="sapUiNoContentPadding sapUiResponsiveMargin sapUiMediumMarginTop"
                    width="100%"
                    headerText="CMO User List"
                >
                    <headerToolbar>
                        <Toolbar>
                            <Title text="CMO User List" />
                            <ToolbarSpacer />
                            <Button
                                id="downloadTableBtn"
                                text="Download Excel"
                                icon="sap-icon://download"
                                type="Transparent"
                                press=".onDownloadTableData"
                            />
                        </Toolbar>
                    </headerToolbar>

                    <!-- === sap.ui.table.Table with Filters Enabled === -->
                    <uiTable:Table
                        id="cmoTable"
                        rows="{JSONModel>/cmoData}"
                        visibleRowCount="6"
                        columnHeaderHeight="35"
                        rowHeight="35"
                        selectionMode="None"
                        width="100%"
                        alternateRowColors="true"
                        enableColumnReordering="true"
                        enableGrouping="false"
                        enableSelectAll="false"
                        enableColumnFreeze="true"
                        enableColumnResize="true"
                        showColumnVisibilityMenu="true"
                        noDataText="No records found. Please upload a file."
                    >
                        <uiTable:columns>
                            <!-- Packaging Site ID -->
                            <uiTable:Column
                                width="20%"
                                visible="{JSONModel>/showColumns}"
                                filterProperty="PackagingSiteID"
                                sortProperty="PackagingSiteID"
                            >
                                <Label text="Packaging Site ID" />
                                <uiTable:template>
                                    <Text text="{JSONModel>PackagingSiteID}" />
                                </uiTable:template>
                            </uiTable:Column>

                            <!-- User ID / Email ID -->
                            <uiTable:Column
                                width="25%"
                                visible="{JSONModel>/showColumns}"
                                filterProperty="UserID"
                                sortProperty="UserID"
                            >
                                <Label text="User ID / Email ID" />
                                <uiTable:template>
                                    <Text text="{JSONModel>UserID}" />
                                </uiTable:template>
                            </uiTable:Column>

                            <!-- Actions -->
                            <uiTable:Column
                                width="10%"
                                hAlign="Center"
                                visible="{JSONModel>/showColumns}"
                            >
                                <Label text="Actions" />
                                <uiTable:template>
                                    <HBox justifyContent="Center" renderType="Bare">
                                        <Button
                                            icon="sap-icon://edit"
                                            type="Ghost"
                                            tooltip="Edit"
                                            press=".onEditRow"
                                            class="sapUiTinyMarginEnd"
                                        />
                                    </HBox>
                                </uiTable:template>
                            </uiTable:Column>
                        </uiTable:columns>
                    </uiTable:Table>
                </Panel>
            </VBox>
        </f:content>

        <!-- Footer -->
        <f:footer>
            <Toolbar>
                <ToolbarSpacer />
                <Button
                    text="Reset"
                    icon="sap-icon://reset"
                    type="Transparent"
                    press="onReset"
                />
                <Button
                    text="Submit"
                    type="Accept"
                    icon="sap-icon://action"
                    press="onSubmitData"
                    
                    id="submitBtn"
                />
            </Toolbar>
        </f:footer>
    </f:DynamicPage>
</mvc:View>
